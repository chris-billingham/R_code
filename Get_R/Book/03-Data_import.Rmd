# Data import

## interactive with Operation System[OS]
get current working `:
```{r}
getwd()
```

Set current working loaction:
```{r eval=FALSE}
setwd("C:/Users/User/Desktop/Mission/R/R_code/Get_R/Book")
```

Get computer info:
```{r message=FALSE}
Sys.info()
```

Get file size:
```{r eval=FALSE}
#install.packages('pryr')
library(pryr)
object_size(mtcars)
```

Check how much memory R is using :
```{r eval=FALSE}
mem_used()
memory.size()
```

Check RAM limit :
```{r warning=FALSE}
memory.limit()
```

Show location files:
```{r message=FALSE}
dir(getwd())
```

Create file A B C:
```{r eval=FALSE}
cat("file A\n", file = "A.txt")
cat("file B\n", file = "B.txt")
cat("file C\n", file = "C.txt")
```

Add BBBB...  to A.txt:
```{r eval=FALSE}
file.append("A.txt", rep("B", 10))
```

Open A.txt:
```{r eval=FALSE}
file.show("A.txt")
```

Open A.txt:
```{r eval=FALSE}
file.show("A.txt")
```

Open ebay.com with firefox:
```{r eval=FALSE}
system(paste('"C:/Program Files (x86)/Mozilla Firefox/firefox.exe"',
             '-url www.ebay.com'))
```

Open ebay.com with defalt browser:
```{r eval=FALSE}
browseURL("www.ebay.com")
```

Delete a file with unlink or file.remove():
```{r eval=FALSE}
unlink("C.txt")
file.remove("A.txt", "B.txt")
```

Check a folder existence:
```{r eval=FALSE}
dir.exists('test_file')
```

Create a folder :
```{r eval=FALSE}
dir.create('test_file')
```

Delete a folder :
```{r eval=FALSE}
unlink('test_file')
```

Download Files:
```{r eval=FALSE}
download.file()
```

Zip A.txt and B.txt into A_B.zip:
```{r eval=FALSE}
zip("A_B.zip", c("A.txt", "B.txt"))
```

Unzip A_B.zip
```{r eval=FALSE}
unzip("A_B.zip")
```


Untar a file:
```{r eval=FALSE}
untar()
```

Check file info:
```{r message=FALSE, warning=FALSE}
library(dplyr)
dir(getwd())%>%file.info()
```


Shutdown Computer in 10 seconds:
```{r eval=FALSE}
shutdown(wait=10)
```


## Play music
```{r eval=FALSE}
library(tuneR)
File1<- readMP3("Becoming_A_Legend.mp3")
play(File1)
```

## image
```{r eval=FALSE}
library(png)
img<-readPNG("R_logo.png")
```

## txt 
Read txt file:
```{r eval=FALSE}
txt_df <- read.table("txt_data.txt", 
                 header = TRUE)
```


## CSV
Read csv file:
```{r eval=FALSE}
csv_df <- read.csv("zipcode.csv", header=TRUE)
```

Create csv file:
```{r eval=FALSE}
write.csv(txt_df, file = "txt_df_out.csv",row.names = FALSE)
```


## Excel

### (without Java)


Read Excel file:
```{r eval=FALSE}
library(readxl)
excel_df1=read_xlsx("df.xlsx", 1)               #read first sheets 
read_excel(datasets, range = "mtcars!B1:D5")    #read mtcars sheets  B1:D5
```


Create Excel file:

```{r eval=FALSE}
library(writexl)
excel_df1=read_xlsx("df.xlsx", 1)               #read first sheets 
read_excel(datasets, range = "mtcars!B1:D5")    #read mtcars sheets  B1:D5
```



### xlsx Package(use Java)

Read Excel file:
```{r eval=FALSE}
library(xlsx)
excel_df1=read.xlsx("df.xlsx", sheetIndex =1)                          #read 1 sheets 
excel_df2=read.xlsx("df.xlsx", sheetIndex =1,startRow=2, colIndex = 2) #read 1 sheets start from 2 row and 2 colmun
```

Create Excel file:
```{r eval=FALSE}
library(xlsx)
write_xlsx(mtcars, path="df.xlsx")
```



## Google sheet
https://www.youtube.com/watch?v=7l2_R61jrUU&list=PLH6mU1kedUy-IW8mi46ZhowTm3-_yQNAQ

## Database 
Coming soon
RJDBC

dplyr


## SAS SPSS Stata Matlab
```{r eval=FALSE}
install.packages("haven")
library(haven)
# SAS
read_sas("mtcars.sas7bdat")
write_sas(mtcars, "mtcars.sas7bdat")

# SPSS
read_sav("mtcars.sav")
write_sav(mtcars, "mtcars.sav")

# Stata
read_dta("mtcars.dta")
write_dta(mtcars, "mtcars.dta")

# matlab
install.packages("R.matlab")
library(R.matlab)
readMat('file.mat'))
```
## Financial data

Money Money Money~

funcation:getSymbols() and Quandl()
source:yahoo finance,google finance,FRED,Oanda


### getSymbols()
```{r eval=FALSE}
# Load the quantmod package
library(quantmod)
# Import EBAY data to xts from Yahoo! Finance
getSymbols("EBAY")
tail(EBAY)
# Import EBAY data from Google Finance
getSymbols("EBAY", src = "google")
# Look at the structure of EBAY
str(EBAY)

```

### Quandl()
```{r eval=FALSE}
# Load the Quandl package
library(Quandl)

# Import GDP data from FRED
gdp <- Quandl("FRED/GDP")

# Look at the structure of the object returned by Quandl
str(gdp)

# Import EBAY data from WIKI
mydata = Quandl("WIKI/EBAY")

# Look at the structure of the object returned by Quandl

library(plotly)
plot_ly(data=mydata%>%filter(Date>='2016-09-01'),x=~Date,y=~Open,mode='lines')

```


return different data format
```{r eval=FALSE}
# Import GDP data from FRED as xts
gdp_xts <- Quandl("FRED/GDP", type = "xts")

# Look at the structure of gdp_xts
str(gdp_xts)

# Import GDP data from FRED as zoo
gdp_zoo <- Quandl("FRED/GDP", type = "zoo")

# Look at the structure of gdp_zoo
str(gdp_zoo)
```


time period:
```{r eval=FALSE}
# Create a currency_pair object
currency_pair <- "GBP/CAD"

# Load British Pound to Canadian Dollar exchange rate data
getSymbols(currency_pair, src = "oanda")

# Examine object using str()
str(GBPCAD)

# Try to load data from 190 days ago
getSymbols(currency_pair, from = Sys.Date() - 190, to = Sys.Date(), src = "oanda")
```
  
  









